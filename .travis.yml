language: python

dist: precise

python:
  - "3.6"

before_install:
  - export TZ=Europe/Brussels
  - if [ ${TRAVIS_PYTHON_VERSION:0:1} == "2" ]; then wget http://repo.continuum.io/miniconda/Miniconda-latest-Linux-x86_64.sh -O miniconda.sh; else wget http://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh -O miniconda.sh; fi
  - bash miniconda.sh -b -p $HOME/miniconda
  - export PATH="$HOME/miniconda/bin:$PATH"
  - conda update --yes conda
  - conda install --yes numpy scipy
  - pip install --quiet pytest pytest-cov pytest-xdist chardet

install:
  - python setup.py install --quiet
  - pip freeze
  # No need to recompile libsvm and liblinear, can rely on the precompiled commited versions, so removes an eventual installed version
  - path_to_libsvm=$(ldconfig -p | grep -m1 "libsvm.so.2" | cut -d ' ' -f4)
  - if [[ -e $path_to_libsvm ]]; then sudo rm -f $path_to_libsvm; fi
  - path_to_liblinear=$(ldconfig -p | grep -m1 "liblinear.so.3" | cut -d ' ' -f4)
  - if [[ -e $path_to_liblinear ]]; then sudo rm -f $path_to_liblinear; fi
  - sudo ldconfig

script:
  - pytest --cov=pattern


after_script:
  - pip install --quiet coveralls
  - coveralls

branches:
only:
  - development

notifications:
  email: false

# You can connect to MySQL/MariaDB using the username "travis" or "root" and a blank password.
services:
  - mysql
